<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GospodÄƒrie â€“ Control & Config</title>

  <style>
    :root{
      --bg:#0f172a;        /* slate-900 */
      --card:#111827;      /* gray-900 */
      --muted:#94a3b8;     /* slate-400 */
      --text:#e5e7eb;      /* gray-200 */
      --accent:#22c55e;    /* green-500 */
      --accent2:#38bdf8;   /* sky-400 */
      --warn:#f59e0b;      /* amber-500 */
      --err:#ef4444;       /* red-500 */
      --border:#1f2937;    /* gray-800 */
    }

    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto;
      background:linear-gradient(180deg,#020617,#020617 30%,#020617);
      color:var(--text);
    }

    header{
      padding:16px 20px; border-bottom:1px solid var(--border);
      display:flex; align-items:center; justify-content:space-between;
    }
    header h1{font-size:18px; margin:0}
    header .sub{color:var(--muted); font-size:12px}

    .wrap{max-width:1100px; margin:0 auto; padding:16px}

    .grid{display:grid; gap:14px}
    .grid-2{grid-template-columns:repeat(auto-fit,minmax(320px,1fr))}

    .card{
      background:rgba(17,24,39,.95);
      border:1px solid var(--border);
      border-radius:14px;
      padding:14px;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .card-header{display:flex; align-items:center; justify-content:space-between; margin-bottom:8px}
    .card-title{font-weight:600}

    .tag{font-size:11px; padding:3px 8px; border-radius:999px; border:1px solid var(--border)}
    .tag-global{color:#a7f3d0; border-color:#065f46}
    .tag-room{color:#bae6fd; border-color:#075985}

    label{display:block; font-size:12px; color:var(--muted); margin-top:8px}
    input{
      width:100%; padding:8px 10px; border-radius:8px;
      border:1px solid var(--border); background:#020617; color:var(--text)
    }

    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px}

    button{
      margin-top:12px; padding:10px 14px; border-radius:10px;
      border:1px solid var(--border); background:#020617; color:var(--text);
      cursor:pointer; font-weight:600
    }
    button.primary{background:linear-gradient(135deg,#22c55e,#16a34a); border:none; color:#052e16}

    .status{font-size:12px; margin-top:6px}
    .status.ok{color:var(--accent)}
    .status.err{color:var(--err)}

    footer{margin:20px 0; text-align:center; color:var(--muted); font-size:12px}
  </style>
</head>
<body>

<header>
  <div>
    <h1>GospodÄƒrie â€“ Dashboard Config</h1>
    <div class="sub">Control centralizat ESP32 Â· ThingSpeak Â· MQTT</div>
  </div>
</header>

<div class="wrap" id="view-control">

  <!-- GLOBAL CONFIG -->
  <div class="card">
    <div class="card-header">
      <div class="card-title">SetÄƒri globale</div>
      <span class="tag tag-global">GLOBAL</span>
    </div>

    <label>Sleep minutes</label>
    <input id="g_sleep" type="number" placeholder="ex: 5" />

    <label>Debug (0/1)</label>
    <input id="g_debug" type="number" placeholder="1" />
  </div>

  <!-- ROOMS -->
  <div class="grid grid-2" style="margin-top:14px;">

    <div class="card">
      <div class="card-header">
        <div class="card-title">CamerÄƒ</div>
        <span class="tag tag-room">Camara</span>
      </div>

      <div class="row">
        <div>
          <label>AlarmÄƒ Temp</label>
          <input id="cam_temp" type="number" placeholder="Â°C" />
        </div>
        <div>
          <label>AlarmÄƒ Umid</label>
          <input id="cam_hum" type="number" placeholder="%" />
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">BucÄƒtÄƒrie</div>
        <span class="tag tag-room">Bucatarie</span>
      </div>

      <div class="row">
        <div>
          <label>AlarmÄƒ Temp</label>
          <input id="buc_temp" type="number" placeholder="Â°C" />
        </div>
        <div>
          <label>AlarmÄƒ Umid</label>
          <input id="buc_hum" type="number" placeholder="%" />
        </div>
      </div>
    </div>

  </div>

  <!-- SAVE ALL -->
  <div class="card" style="margin-top:14px;">
    <div class="card-header">
      <div class="card-title">Salvare configuraÈ›ie</div>
      <span class="tag tag-global">ALL</span>
    </div>

    <button class="primary" onclick="saveAllConfig()">ðŸ’¾ SalveazÄƒ TOT</button>
    <div id="status-all" class="status"></div>
  </div>

</div>

<footer>
  Â© GospodÄƒrie Â· Dashboard simplu & robust
</footer>

<script>
  const WRITE_KEY = "ZPT57WZJNMLGM2X1"; // ThingSpeak WRITE KEY

  function qs(id){return document.getElementById(id).value}

  function saveAllConfig(){
    let params = [];

    if(qs('g_sleep')) params.push('field1='+qs('g_sleep'));
    if(qs('g_debug')) params.push('field8='+qs('g_debug'));

    if(qs('cam_temp')) params.push('field2='+qs('cam_temp'));
    if(qs('cam_hum'))  params.push('field3='+qs('cam_hum'));

    if(qs('buc_temp')) params.push('field6='+qs('buc_temp'));
    if(qs('buc_hum'))  params.push('field7='+qs('buc_hum'));

    if(params.length===0){
      setStatus('status-all','Nimic de salvat','err');
      return;
    }

    const url = `https://api.thingspeak.com/update?api_key=${WRITE_KEY}&`+params.join('&');

    fetch(url)
      .then(r=>r.text())
      .then(t=>{
        if(t!=='0') setStatus('status-all','Config salvat âœ”','ok');
        else setStatus('status-all','Eroare ThingSpeak','err');
      })
      .catch(()=>setStatus('status-all','Network error','err'));
  }

  function setStatus(id,msg,type){
    const el=document.getElementById(id);
    el.textContent=msg; el.className='status '+type;
  }
</script>

</body>
</html>
