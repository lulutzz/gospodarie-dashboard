<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>MQTT Test</title>

<!-- ðŸ”¥ Biblioteca MQTT â€“ obligatoriu prima! -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/mqttws31.min.js"></script>

</head>
<body style="background:black;color:#0f0;font-family:monospace;padding:20px">
<h2>MQTT Test</h2>
<pre id="log">Loading MQTT...1</pre>

<script>
function log(msg){
    document.getElementById("log").textContent += "\n" + msg;
}

const HOST = "c72cc38c1f184d0199cc4daa938bac6f.s1.eu.hivemq.cloud";
const PORT = 8884;
const PATH = "/mqtt";
const USER = "burlusi";
const PASS = "Burlusi166?";
const clientId = "WEBTEST_" + Math.random().toString(16).substr(2,8);

log("Connecting...");

let client = new Paho.MQTT.Client(HOST, PORT, PATH, clientId);

client.onConnectionLost = (r)=>{
    log("Connection lost: " + r.errorMessage);
};

client.onMessageArrived = (m)=>{
    log("MSG: " + m.destinationName + " = " + m.payloadString);
};

client.connect({
    useSSL: true,
    userName: USER,
    password: PASS,
    timeout: 5,
    cleanSession: true,
    onSuccess: ()=>{
        log("Connected!");
        client.subscribe("/gosp/+/status");
        client.subscribe("/gosp/+/log");
        log("Subscribed!");
    },
    onFailure: (e)=>{
        log("Connect ERROR: " + e.errorMessage);
    }
});
</script>

</body>
</html>
